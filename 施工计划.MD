# 施工计划 (Implementation Plan)

版本: v1.0

日期: 2026-02-22

对应: 技术方案2.txt v2.0


## 0. 总目标 (Goals)

- 交付可在 BSC mainnet fork 运行的自驱动收益引擎 (Self-Driving Yield Engine)

- 满足题目四大支柱 (Integrate / Stack / Automate / Protect)

- 保证非托管 (Non-Custodial) 与去中心化 (Decentralized)

- 通过完整测试与文档验收


## 1. 里程碑 (Milestones)

- M0: 工具链与链上接口就绪 (Foundry + ABI + fork)

- M1: 三大适配器可用 (ALP / V2 / 1001x)

- M2: 波动率 Oracle + Regime 切换可用

- M3: EngineVault 主循环完成

- M4: Flash Rebalance + WithdrawalQueue 完成

- M5: 安全模型 + 经济模型 + 文档完善

- M6: Demo 录制 + 最终验收


## 1.1 里程碑进度 (Progress)

- [x] M0: 工具链与链上接口就绪

- [x] M1: 三大适配器可用

- [x] M2: 波动率 Oracle + Regime 切换可用

- [x] M3: EngineVault 主循环完成

- [x] M4: Flash Rebalance + WithdrawalQueue 完成

- [ ] M5: 安全模型 + 经济模型 + 文档完善

- [ ] M6: Demo 录制 + 最终验收


## 2. 验收标准总则 (Definition of Done)

- 合约无 owner/admin/onlyRole (Zero-Admin)

- cycle() 与 claimWithdraw() 完全 permissionless

- 所有关键参数 immutable

- Foundry fork 测试 A-F 全绿

- 不变量测试通过

- 文档齐备 (README / ARCHITECTURE / THREAT_MODEL / ECONOMICS)


## 3. 逐部分验收 (Mapping to 技术方案2)

### Part1 题目分析与评估

- [ ] 文档明确四大支柱要求与限制条件

- [ ] Design Prompts (Hedging / Volatility / Resilience) 有对应解法

- [ ] 评分权重与策略改进逻辑清晰


### Part2 竞品分析

- [ ] 至少 2 个竞品案例

- [ ] 优缺点与差异化矩阵完整

- [ ] 明确非托管冲突点 (asUSDF)


### Part3 核心创新 (ALP 双重引擎)

- [ ] ALP 收益来源拆解完整

- [ ] 证明 ALP 对冲 LP IL 的逻辑链

- [ ] 数学关系与配置原则清晰


### Part4 系统架构

- [x] 架构图覆盖 Vault / Adapters / Oracle / Queue

- [x] 仓库目录结构与文件命名落地

- [ ] 链上地址与关键参数可验证


### Part5 核心合约设计

- [x] EngineVault: ERC-4626 接口齐全

- [x] VolatilityOracle: TWAP + 采样窗口可运行

- [x] Aster1001xAdapter: ABI 精度与字段校验

- [x] PancakeV2Adapter: add/remove + LP 拆解

- [x] FlashRebalancer: pancakeCall 安全校验


### Part6 核心算法

- [x] 动态配比 (Regime Switching) 正常工作

- [x] Delta 对冲逻辑回到 band 内

- [x] Flash Rebalance 单笔完成再平衡

- [x] Bounty 公式包含 gasPrice cap + buffer cap (OpenCode 补充)


### Part7 状态机与资金流

- [x] deposit 不立即部署资产

- [x] cycle() 按 Phase 0-6 完整执行

- [x] 冷启动 (MIN_SAMPLES) 时 Regime = NORMAL (OpenCode 补充)

- [x] snapshot 采样间隔受 minSnapshotInterval 限制

- [x] claimWithdraw 支持 partial claim + bounty 激励 (OpenCode 补充)


### Part8 安全模型

- [x] 无管理员权限与外部 keeper

- [x] MEV 防护: slippage + deadline + Flash

- [x] 风险分层与熔断规则可验证

- [x] ONLY_UNWIND 模式落地与解除条件明确 (OpenCode 补充)


### Part9 经济模型与收益模拟

- [x] 三场景 (CALM/NORMAL/STORM) 收益模拟完备

- [x] Sharpe Ratio 估算合理

- [x] 敏感性/压力测试包含 fee / funding / gas / 单边行情 (OpenCode 补充)


### Part10 测试计划

- [ ] Fork 测试 A-F 通过

- [x] Foundry 测试全绿 (11 tests)

- [x] 不变量测试通过 (Invariant.t.sol)

- [x] Fork demo script 运行成功

- [x] negative case 覆盖 (ONLY_UNWIND 触发)



### Part11 验收条件

- [ ] 非托管与去中心化硬约束通过

- [ ] Integrate / Stack / Automate / Protect 全部满足

- [ ] 代码质量 (fmt / slither / lint) 通过

- [ ] Demo 与 README 按时交付

- [x] 文档齐备 (README / ARCHITECTURE / THREAT_MODEL / ECONOMICS)


### Part12 施工任务拆分

- [x] Task 0-7 已完成

- [ ] Task 8-9 待完成

- [ ] 每个任务有明确可验证输出


### 附录 A 设计哲学

- [ ] README 中完整呈现 Why/What/How/Assumptions/Sustainability/Resilience


### 附录 B 关键参考

- [ ] 关键地址与费用参数链上核对完毕


### 附录 C 差异总结

- [ ] 差异矩阵与 OpenCode 补充项一致


## 4. 交付物清单 (Deliverables)

- 合约代码 (contracts/core | adapters | libs | interfaces)

- 测试代码 (fork + unit + invariant)

- 文档 (README / ARCHITECTURE / THREAT_MODEL / ECONOMICS)

- Demo 视频 (<= 3 分钟)


## 5. 链上核对清单 (On-Chain Checklist)

- Pancake V2 fee 与 INIT_CODE_HASH

- ALP burn cap 公式与 cooling 细节

- 1001x funding 与 price 精度

- USDT / BTCB decimals


## 6. 证据要求 (Evidence)

- fork 测试日志

- 事件日志 (CycleExecuted / RegimeSwitched)

- Demo 录屏与关键交易 hash
